<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> <!--skip-->
        <title>Accuratus Chat Window</title>
        <link rel="stylesheet" type="text/css" href="/easyrtc/easyrtc.css" />

        <!--hide-->
        <link rel="stylesheet" type="text/css" href="css/landing.css" />
        <link rel="stylesheet" type="text/css" href="css/demo_audio_video_simple.css" />
        <!-- Prettify Code -->
        <script type="text/javascript" src="js/prettify/prettify.js"></script>
        <script type="text/javascript" src="js/prettify/loadAndFilter.js"></script>
        <script type="text/javascript" src="js/prettify/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="js/prettify/prettify.css" />
        	
        <!--show-->
        <!-- Assumes global locations for socket.io.js and easyrtc.js -->
        <script src="/socket.io/socket.io.js"></script>
        <script type="text/javascript" src="/easyrtc/easyrtc.js"></script>
        
		
       <script type="text/javascript" src="js/demo_instant_messaging.js"></script>
        <!--hide-->
        <!-- Styles used within the demo -->
        <style type="text/css">
            #stuffToSend {width:300px;}
            #sendMessageArea{
                float:left;
                width:400px;
                padding-right:20px;
            }
            #sendMessageText{
                width:100%;
            }
            #conversation {
                height:300px;
                border:solid 1px gray;
                overflow-y:scroll;
            }
        </style>
        
        
        
        
        
        <script type="text/javascript" src="js/demo_data_channel_filesharing.js"></script>

        <!--hide-->
        <!-- Styles used within the demo -->
        <style type="text/css">
            .alert img {
                float:left;
                padding-right: 10px;
            }

            .peerblock {
                width: 800px;
                border-radius:2px;
                border:1px solid gray;
            }

            .receiveBlock {
                width: 500px;
                margin:10px;
                display: inline-block;
            }
            .dragndrop {
                display: inline-block;
                padding:2em;
                margin: 2px;
                border:2px solid black;
                border-radius: 5px;
            }
            .dragndropStatus {
                display: inline-block;
            }
            .connecting {
                background-color: yellow;
            }
            .usesSockets {
                background-color: pink;
            }
            .notConnected {
                visibility:hidden;
            }
            .connected {
                background-color: #e0ffe0;
            }
            .notConnected:hover {
                margin: 1px;
                border-width: 3px;
            }
            .connected:hover {
                margin: 1px;
                border-width:3px;
            }
            .connectButton {
                padding:2em;
            }

        </style>
        
        
        
        
        <script type="text/javascript" src="js/demo_audio_video_simple.js"></script>
        
        
         <script>
            if(location.href.indexOf('file:') == 0) {
                document.write('<h1 style="color:red;">Please load this HTML file on HTTP or HTTPS.</h1>');
            }
        </script>

 









         

    </head>
    <body onload="connect();">
        <!--hide-->
        <div id="container1">
            
             <div id="menu"></div>
           

<div id="main">          
                <h2>The Accuratus Chat Application</h2>
                <!--show-->
                <div id="demoContainer">
                    

                    <div id="videos">
                        
                <div style="position:relative;float:left;">                        
                <video autoplay="autoplay" id="callerVideo"  controls></video>
                </div>
                
                <video autoplay="autoplay" class="easyrtcMirror" id="selfVideo" muted="muted"></video>
                                       
                <!-- each caller video needs to be in it's own div so it's close button can be positioned correctly -->
                    </div>
                    
                
                    
                    
                </div>
                <!--hide-->
                <br style="clear:both;" />
                <hr />



                <!-- Runs the SyntaxHighlighter -->
               

                <!-- End Main Content -->
            </div>
            
        </div>

            
<div id="container2">
           <div id="menu">
             <div id="main">

                <!-- Main Content -->
                <h2>Accuratus Instant Messaging</h2>
                
                
                <!--show-->
                <div id="sendMessageArea">
                    <div id="iam">Obtaining ID...</div>
                    <textarea id="sendMessageText"></textarea>
                    <div id="otherClients"></div>
                </div>
                <div id="receiveMessageArea">
                    Received Messages:
                    <div id="conversation"></div>
                </div>

                <!--hide-->
                


                <!-- Runs the SyntaxHighlighter -->
                

                <!-- End Main Content -->
            </div>
            <!--hide-->
            </div>
        </div>


 <div id="container3">
            
            <div id="main">
                <!-- Main Content -->
                <h1>Accuratus Document Sharing</h1>
                
               
                
                <div id="iam">Obtaining ID...</div><BR />
                <div id="peerZone">
                </div>

                
                
                <!--hide-->
                <hr />

               
        </div>

</div>










 
             <script>
var startRecording = document.getElementById('start-recording');
var stopRecording = document.getElementById('stop-recording');
var cameraPreview = document.getElementById('callerVideo');

var mRecordRTC = new MRecordRTC();
mRecordRTC.mediaType = {
	audio: true,
	video: true
};

mRecordRTC.bufferSize = 16384;
mRecordRTC.canvas = {
	width: innerWidth,
	height: innerHeight
};

var recordAudio, recordVideo;
startRecording.onclick = function() {
    startRecording.disabled = true;
    var video_constraints = {
        mandatory: { },
        optional: []
    };
   

            mRecordRTC.addStream(stream);
			mRecordRTC.startRecording();

          
};

var fileName;
stopRecording.onclick = function() {
    startRecording.disabled = false;
    stopRecording.disabled = true;

    fileName = Math.round(Math.random() * 99999999) + 99999999;

    mRecordRTC.stopRecording();

    mRecordRTC.getDataURL(function(dataURL) {
        var files = {
                audio: {
                    name: fileName + '.wav',
                    type: 'audio/wav',
                    contents: dataURL.audio
                },
                video: {
                    name: fileName + '.webm',
                    type: 'video/webm',
                    contents: dataURL.video
                }
            };

            cameraPreview.src = '';
            cameraPreview.poster = '/ajax-loader.gif';

            xhr('/upload', JSON.stringify(files), function(fileName) {
                var href = location.href.substr(0, location.href.lastIndexOf('/') + 1);
                cameraPreview.src = href + 'uploads/' + fileName;
                cameraPreview.play();
            });
    });
};

function xhr(url, data, callback) {
    var request = new XMLHttpRequest();
    request.onreadystatechange = function() {
        if (request.readyState == 4 && request.status == 200) {
            callback(request.responseText);
        }
    };
    request.open('POST', url);
    request.send(data);
}		

</script>





          
        <!--show-->
    </body>
</html>
